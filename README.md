# zhihuishu-tool

## 长期暂停维护通知

各位用户及项目贡献者们，非常抱歉，由于个人时间缘故，该项目暂时停止维护。（至少2022年上学期是无法抽出时间维护了）
非常感谢每一个Pull request的贡献，虽然此期间暂停维护，但如果你在逆向中遇到困难仍然可以随时通过issue或其他方式联系我，我会尽力提供帮助。（仅回答学习交流目的问题，批量代刷目的不作答复）
此处为仓库发布时的逆向分析记录，可以供参考：https://www.bilibili.com/read/cv15620703

2022-11-10 luoyily.

以下简单聊聊截至2022-11月的变化：

1. 网站启用易盾验证码作为登录验证。（之后建议通过二维码或者cookie登录）
2. 网站使用了新的ob混淆(类似一个array加上一个函数控制了整个js的字符串，可读性大幅下降，但并不影响调试，可以参考之前的记录快速定位关键位置，也可以试试AST还原)
3. 视频页面增加反调试。
  大概看了下，此反调试比较恶心，提前hook会被检测，导致页面部分代码无法被加载（大概破坏后会走进while (!![]) {switch (_0xf62fd9[_0x2bd61a++])），例如RSA，AES等。可以本地替换或者Fiddler自动响应替换，但任何直接破坏了反调试的行为都会导致页面无法正常加载。这里我的处理方案是，没必要硬刚分析到底，等待页面加载完成后，控制台Hook Function来过掉反调试。此时调试均正常，如果有页面加载前的请求漏掉了，可以提前开Fiddler进行抓包。
4. 视频页进度请求键名有一些变化。 
5. 总之，网页变了很多，但请求几乎就是加个时间戳啥的，原仓库代码改改还能用。

吐槽两句：
反抗形式主义果然还是不容易= =，强制让学生完成这些网课又有什么意义？有人会看吗，整个平台又有几个值得这些学生花时间看的课程。无非最后网课平台与高校能牟利罢了。

## 关于

知到，智慧树 API 及工具

个人学习JS逆向以及爬虫练习使用，随缘维护。

----------------

## 快速开始

本项目使用python 3.x 编写

## 依赖安装

```shell
pip install -r requirements.txt
```

## 简易文档

`zhi_api.py`为智慧树API，各个参数在注释中有写明。

注意：

1. 使用时page_size尽可能保持默认。
2. 原始数据为什么用字符串：懒，为了保持和客户端加密结果完全相同
3. 部分页面cookie无效：请参考浏览器请求url中带有`login?service`的请求，在访问它们前get一下，来登录相应页面。

---------------------------

`share_course.py`为一个简单的提交共享学分课学习进度（刷课）工具。

说明：登录账号后，将每个课程学习25分钟多一点，可选秒过（可能提示异常）或者按正常时间挂机，遇到弹题会自动做答为正确答案，输出的信息中`{'code': 0, 'message': '请求成功', 'data': {'submitSuccess': True}}`代表提交成功。

-----

`meet_course.py`为提交见面课进度的工具。

说明：登录账号后会查询你未完成的见面课，可选择全部完成或完成某个。输出`jsonpCallBack(true)`为提交成功。

-----

`auto_qa`为自动刷互动分工具。

说明：登陆后可选择需要刷的课程，原理是复读别人回答的答案。

TODO：

1. ~~自动刷互动分~~
2. ~~自由指定刷哪些课，以及刷多久~~（貌似没啥用，鸽了，之后加个刷完全部的就行）
3. ~~支持刷见面课~~

